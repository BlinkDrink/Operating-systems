<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>1.2</title>
  <link rel="stylesheet" href="https://stackedit.io/style.css" />
</head>

<body class="stackedit">
  <div class="stackedit__html"><p><a href="https://drive.google.com/file/d/1W7nO7o6HdBlX7_W8NHI7whcoSU3bO4MU/view?usp=share_link">https://drive.google.com/file/d/1W7nO7o6HdBlX7_W8NHI7whcoSU3bO4MU/view?usp=share_link</a></p>
<h3 id="se-01">15. 2016-SE-01</h3>
<pre class=" language-bash"><code class="prism  language-bash"><span class="token function">find</span> <span class="token keyword">.</span> -type l -printf <span class="token string">"%p %Y\n"</span> <span class="token operator">|</span> <span class="token function">awk</span> <span class="token string">'<span class="token variable">$2</span> == "N" {print <span class="token variable">$1</span>}'</span>
<span class="token function">find</span> -L <span class="token keyword">.</span> -type l -print
</code></pre>
<h3 id="se-02">16. 2016-SE-02</h3>
<pre class=" language-bash"><code class="prism  language-bash"><span class="token shebang important">#! /bin/bash</span>
reg<span class="token operator">=</span><span class="token string">'^[0-9]+$'</span>
<span class="token punctuation">[</span> $<span class="token comment"># -eq 1 ] || exit 1</span>
<span class="token punctuation">[</span> <span class="token variable"><span class="token variable">$(</span><span class="token function">id</span> -u<span class="token variable">)</span></span> -eq 0 <span class="token punctuation">]</span> <span class="token operator">||</span> <span class="token keyword">exit</span> 2
<span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token variable">$1</span> <span class="token operator">=</span>~ <span class="token variable">$reg</span> <span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">||</span> <span class="token keyword">exit</span> 3
T<span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span>mktmp<span class="token variable">)</span></span>
<span class="token function">ps</span> -e -o uid,pid,rss <span class="token operator">&gt;</span> <span class="token variable">$T</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token punctuation">$(</span>awk <span class="token string">'{print <span class="token variable">$1</span>}'</span> <span class="token variable">$T</span> <span class="token operator">|</span> <span class="token function">sort</span> <span class="token operator">|</span> <span class="token function">uniq</span> <span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">do</span>
	R<span class="token operator">=</span><span class="token punctuation">$(</span>awk -v foo<span class="token operator">=</span><span class="token variable">$i</span> <span class="token string">'<span class="token variable">$1</span> == <span class="token variable">$foo</span> {s+=<span class="token variable">$3</span>} END {print s}'</span> <span class="token variable">$T</span><span class="token punctuation">)</span>
	<span class="token keyword">echo</span> <span class="token string">"<span class="token variable">$i</span> <span class="token variable">$R</span>"</span>
	<span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token variable">$R</span> -le <span class="token variable">$1</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
	<span class="token keyword">continue</span>
	<span class="token keyword">fi</span>
	P<span class="token operator">=</span><span class="token punctuation">$(</span>grep <span class="token string">"<span class="token variable">$i</span>"</span> <span class="token variable">$T</span> <span class="token operator">|</span> <span class="token function">sort</span> -rn -k 2,2 <span class="token operator">|</span> <span class="token function">head</span> -n 1 <span class="token operator">|</span> <span class="token function">awk</span> <span class="token string">'{print <span class="token variable">$1</span>}'</span><span class="token punctuation">)</span>
	<span class="token function">kill</span> -15 <span class="token variable">$P</span>
	<span class="token function">sleep</span> 2
	<span class="token function">kill</span> -9 <span class="token variable">$P</span>
<span class="token keyword">done</span>
<span class="token function">rm</span> -- <span class="token variable">$T</span>
</code></pre>
<h3 id="se-03">17. 2016-SE-03</h3>
<pre class=" language-bash"><code class="prism  language-bash"><span class="token shebang important">#! /bin/bash</span>
<span class="token keyword">while</span> <span class="token function">read</span> U H<span class="token punctuation">;</span> <span class="token keyword">do</span>
	<span class="token keyword">if</span> <span class="token punctuation">[</span> -z <span class="token variable">$H</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
		<span class="token keyword">echo</span> <span class="token string">"<span class="token variable">$U</span>"</span>
		<span class="token keyword">continue</span>
	<span class="token keyword">fi</span>
	<span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token operator">!</span> -d <span class="token string">"<span class="token variable">$H</span>"</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
		<span class="token keyword">echo</span> <span class="token string">"<span class="token variable">$U</span>"</span>
		<span class="token keyword">continue</span>
	<span class="token keyword">fi</span>
	MyUsr<span class="token operator">=</span><span class="token punctuation">$(</span>stat -c <span class="token string">"%U"</span> <span class="token variable">$H</span><span class="token punctuation">)</span>
	<span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token string">"<span class="token variable">$MyUsr</span>"</span> <span class="token operator">!=</span> <span class="token string">"<span class="token variable">$U</span>"</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
		<span class="token keyword">echo</span> <span class="token string">"<span class="token variable">$U</span>"</span>
		<span class="token keyword">continue</span>
	<span class="token keyword">fi</span>
	M<span class="token operator">=</span><span class="token punctuation">$(</span>stat -c <span class="token string">"%A"</span> <span class="token variable">$H</span> <span class="token operator">|</span> <span class="token function">cut</span> -c 3<span class="token punctuation">)</span>
	<span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token string">"<span class="token variable">$M</span>"</span> <span class="token operator">!=</span> <span class="token string">"w"</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
		<span class="token keyword">echo</span> <span class="token string">"<span class="token variable">$U</span>"</span>
		<span class="token keyword">continue</span>
	<span class="token keyword">fi</span>
<span class="token keyword">done</span> <span class="token operator">&lt;</span> <span class="token operator">&lt;</span><span class="token punctuation">(</span>cat /etc/passwd <span class="token operator">|</span> <span class="token function">awk</span> -F <span class="token string">":"</span> <span class="token string">'{print <span class="token variable">$1</span> " " <span class="token variable">$6</span>}'</span><span class="token punctuation">)</span>
</code></pre>
<h3 id="se-04">19. 2016-SE-04</h3>
<pre class=" language-bash"><code class="prism  language-bash"><span class="token shebang important">#! /bin/bash</span>
<span class="token punctuation">[</span> $<span class="token comment"># -eq 2 ] || exit 1</span>
targetFile<span class="token operator">=</span><span class="token string">""</span>
<span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token punctuation">$(</span>grep <span class="token string">"<span class="token variable">$1</span>"</span> <span class="token variable">$1</span> <span class="token operator">|</span> <span class="token function">wc</span> -l<span class="token punctuation">)</span> -gt <span class="token punctuation">$(</span>grep <span class="token string">"<span class="token variable">$2</span>"</span> <span class="token variable">$2</span> <span class="token operator">|</span> <span class="token function">wc</span> -l<span class="token punctuation">)</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
        targetFile<span class="token operator">=</span><span class="token variable">$1</span>
<span class="token keyword">else</span>
        targetFile<span class="token operator">=</span><span class="token variable">$2</span>
<span class="token keyword">fi</span>
<span class="token function">cut</span> -d <span class="token string">"-"</span> -f 2- <span class="token variable">$targetFile</span> <span class="token operator">|</span> <span class="token function">sort</span>
</code></pre>
<h3 id="se-04-1">20. 2016-SE-04</h3>
<pre class=" language-bash"><code class="prism  language-bash"><span class="token shebang important">#! /bin/bash</span>
<span class="token punctuation">[</span> $<span class="token comment"># -eq 1 ] || exit 1</span>
<span class="token function">cat</span> <span class="token variable">$1</span> <span class="token operator">|</span> <span class="token function">sed</span> -E <span class="token string">"s/ - / : /2"</span> <span class="token operator">|</span> <span class="token function">awk</span> -F <span class="token string">" - "</span> <span class="token string">'{counter+=1; print counter ".  : " <span class="token variable">$2</span>}'</span> <span class="token operator">|</span> <span class="token function">sort</span> -t <span class="token string">":"</span> -k 2,2 <span class="token operator">|</span> <span class="token function">sed</span> -E <span class="token string">"s/ : / - /2"</span> <span class="token operator">|</span> <span class="token function">sed</span> -E <span class="token string">"s/ : //1"</span>
</code></pre>
<h3 id="se-04-2">21. 2016-SE-04</h3>
<pre class=" language-bash"><code class="prism  language-bash"><span class="token shebang important">#! /bin/bash</span>
<span class="token punctuation">[</span> $<span class="token comment"># -eq 3 ] || exit 1</span>
str1Val<span class="token operator">=</span><span class="token punctuation">$(</span>grep <span class="token string">"<span class="token variable">$2</span>="</span> <span class="token variable">$1</span> <span class="token operator">|</span> <span class="token function">cut</span> -d <span class="token string">"="</span> -f 2<span class="token punctuation">)</span>
str2Val<span class="token operator">=</span><span class="token punctuation">$(</span>grep <span class="token string">"<span class="token variable">$3</span>="</span> <span class="token variable">$1</span> <span class="token operator">|</span> <span class="token function">cut</span> -d <span class="token string">"="</span> -f 2<span class="token punctuation">)</span>
newStr2<span class="token operator">=</span><span class="token string">""</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token variable">$str2Val</span><span class="token punctuation">;</span> <span class="token keyword">do</span>
        cmd<span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token keyword">echo</span> $str1Val <span class="token operator">|</span> <span class="token function">grep</span> $i<span class="token variable">)</span></span>
        <span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token variable">$?</span> -eq 1 <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
                newStr2<span class="token operator">=</span><span class="token string">"<span class="token variable">${newStr2}</span> <span class="token variable">${i}</span>"</span>
        <span class="token keyword">fi</span>
<span class="token keyword">done</span>
newStr2<span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token keyword">echo</span> $newStr2<span class="token variable">)</span></span>
<span class="token function">sed</span> -E <span class="token string">"s/(<span class="token variable">$3</span>=).*/\1<span class="token variable">$newStr2</span>/"</span> <span class="token variable">$1</span>
</code></pre>
<h3 id="se-04-3">22. 2016-SE-04</h3>
<pre class=" language-bash"><code class="prism  language-bash"><span class="token shebang important">#! /bin/bash</span>
<span class="token punctuation">[</span> $<span class="token comment"># -eq 1 ] || exit 1</span>
<span class="token punctuation">[</span> <span class="token variable"><span class="token variable">$(</span><span class="token function">id</span> -u<span class="token variable">)</span></span> -eq 0 <span class="token punctuation">]</span> <span class="token operator">||</span> <span class="token keyword">exit</span> 2
T<span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span>mktmp<span class="token variable">)</span></span>
fooProcesses<span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">ps</span> -u $1 -U $1 <span class="token operator">|</span> <span class="token function">wc</span> -l<span class="token variable">)</span></span> <span class="token comment"># count of processes of target user</span>
<span class="token function">ps</span> -e -o user,pid,time --sort user <span class="token operator">&gt;</span> <span class="token variable">$T</span> <span class="token comment"># copy current snapshot of all processes to $T</span>
<span class="token function">awk</span> <span class="token string">'{print <span class="token variable">$1</span>}'</span> <span class="token variable">$T</span> <span class="token operator">|</span> <span class="token function">uniq</span> -c <span class="token operator">|</span> <span class="token function">sort</span> -k 1,1n <span class="token operator">|</span> <span class="token function">awk</span> -v targetCnt<span class="token operator">=</span><span class="token variable">$fooProcesses</span> <span class="token string">'<span class="token variable">$1</span> &gt; targetCnt {print <span class="token variable">$2</span>}'</span> <span class="token comment"># Print all users who have more processes than FOO user</span>
<span class="token function">awk</span> <span class="token string">'{seconds=system(echo <span class="token variable">$3</span> | awk -F ":" '</span><span class="token punctuation">{</span>totalSeconds<span class="token operator">=</span> <span class="token variable">$1*3600</span> + <span class="token variable">$2</span> * 60 + <span class="token variable">$3</span><span class="token punctuation">;</span> print totalSeconds<span class="token punctuation">}</span><span class="token string">'); print <span class="token variable">$2</span> " " seconds}'</span> <span class="token variable">$T</span> <span class="token operator">&gt;</span> <span class="token variable">$T</span> <span class="token comment"># convert format from {user pid HH:MM:SS} to {pid seconds}</span>
<span class="token comment"># averageTime=$(awk '{seconds=system(echo $2 | awk -F ":" '{totalSeconds= $1*3600 + $2 * 60 + $3; print totalSeconds}')} END {print seconds / NR}' $T)</span>
avgTime<span class="token operator">=</span><span class="token punctuation">$(</span>awk <span class="token string">'{sum+=<span class="token variable">$2</span>} END {print sum / NR}'</span> <span class="token variable">$T</span><span class="token punctuation">)</span>
<span class="token keyword">echo</span> <span class="token variable">$avgTime</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token punctuation">$(</span>awk -v avg<span class="token operator">=</span><span class="token variable">$avgTime</span> <span class="token string">'<span class="token variable">$2</span> &gt; avg*2 {print <span class="token variable">$1</span>}'</span> <span class="token variable">$T</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">do</span>
	<span class="token function">kill</span> -15 <span class="token variable">$i</span>
	<span class="token function">sleep</span> 2
	<span class="token function">kill</span> -9 <span class="token variable">$i</span>
<span class="token keyword">done</span>
<span class="token function">rm</span> -i -r <span class="token variable">$T</span>
</code></pre>
<h3 id="in-03">23. 2017-IN-03</h3>
<pre class=" language-bash"><code class="prism  language-bash"><span class="token shebang important">#! /bin/bash</span>
latestFile<span class="token operator">=</span><span class="token string">""</span>
<span class="token keyword">while</span> <span class="token function">read</span> U H<span class="token punctuation">;</span> <span class="token keyword">do</span>
	currFile<span class="token operator">=</span>find <span class="token variable">$H</span> -type f -printf <span class="token string">"%p %T@\n"</span> <span class="token operator">|</span> <span class="token function">sort</span> -k 2,2n <span class="token operator">|</span> <span class="token function">tail</span> -n 1 <span class="token operator">|</span> <span class="token function">awk</span> -v 
	<span class="token keyword">if</span> <span class="token punctuation">[</span> -z <span class="token variable">$latestFile</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
		latestFile<span class="token operator">=</span><span class="token variable">$currFile</span>
		<span class="token keyword">continue</span>
	<span class="token keyword">fi</span>

	<span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token punctuation">$(</span>echo <span class="token variable">$currFile</span> <span class="token operator">|</span> <span class="token function">awk</span> <span class="token string">'{print <span class="token variable">$2</span>}'</span><span class="token punctuation">)</span> -gt <span class="token punctuation">$(</span>echo <span class="token variable">$latestFile</span> <span class="token operator">|</span> <span class="token function">awk</span> <span class="token string">'{print <span class="token variable">$2</span>}'</span><span class="token punctuation">)</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
		latestFile<span class="token operator">=</span><span class="token variable">$currFile</span>
	<span class="token keyword">fi</span>
<span class="token keyword">done</span> <span class="token operator">&lt;</span> <span class="token operator">&lt;</span><span class="token punctuation">(</span>cat /etc/passwd <span class="token operator">|</span> <span class="token function">awk</span> -F <span class="token string">":"</span> <span class="token string">'{print <span class="token variable">$1</span> " " <span class="token variable">$6</span>}'</span><span class="token punctuation">)</span>
<span class="token keyword">echo</span> <span class="token variable">$latestFile</span>
</code></pre>
<h3 id="se-01-1">24. 2017-SE-01</h3>
<pre class=" language-bash"><code class="prism  language-bash"><span class="token shebang important">#! /bin/bash</span>
<span class="token punctuation">[</span> $<span class="token comment"># -ge 1 ] || exit 1</span>
<span class="token keyword">if</span> <span class="token operator">!</span> <span class="token punctuation">[</span> -z <span class="token variable">$2</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
	<span class="token function">find</span> <span class="token variable">$1</span> -printf <span class="token string">"%p %n\n"</span> <span class="token operator">|</span> <span class="token function">awk</span> -v links<span class="token operator">=</span><span class="token variable">$2</span> <span class="token string">'<span class="token variable">$2</span> &gt;= links {print <span class="token variable">$1</span>}'</span>
	<span class="token keyword">exit</span> 0
<span class="token keyword">fi</span>
<span class="token function">find</span> <span class="token variable">$1</span> -type l -printf <span class="token string">"%p %Y\n"</span> <span class="token operator">|</span> <span class="token function">awk</span> <span class="token string">'<span class="token variable">$2</span> == "N" {print <span class="token variable">$1</span>}'</span>
</code></pre>
<h3 id="se-02-1">25. 2017-SE-02</h3>
<pre class=" language-bash"><code class="prism  language-bash"><span class="token shebang important">#! /bin/bash</span>
src<span class="token operator">=</span><span class="token string">"<span class="token variable"><span class="token variable">$(</span><span class="token function">dirname</span> $1<span class="token variable">)</span></span>/<span class="token variable"><span class="token variable">$(</span><span class="token function">basename</span> $1<span class="token variable">)</span></span>"</span>
dst<span class="token operator">=</span><span class="token string">"<span class="token variable"><span class="token variable">$(</span><span class="token function">dirname</span> $2<span class="token variable">)</span></span>/<span class="token variable"><span class="token variable">$(</span><span class="token function">basename</span> $2<span class="token variable">)</span></span>"</span>
str<span class="token operator">=</span><span class="token string">"<span class="token variable">${3}</span>"</span>
<span class="token keyword">echo</span> <span class="token string">"<span class="token variable">$src</span> <span class="token variable">$dst</span> <span class="token variable">$str</span>"</span>
<span class="token keyword">for</span> result <span class="token keyword">in</span> <span class="token punctuation">$(</span>find <span class="token variable">$1</span> -type f -name <span class="token string">"*<span class="token variable">${str}</span>*"</span> 2<span class="token operator">&gt;</span>/dev/null<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">do</span>
        <span class="token keyword">echo</span> <span class="token string">"<span class="token variable">$result</span>"</span>
        NN<span class="token operator">=</span><span class="token punctuation">$(</span>echo <span class="token variable">$result</span> <span class="token operator">|</span> <span class="token function">sed</span> -E <span class="token string">"s|^<span class="token variable">${src}</span>|<span class="token variable">${dst}</span>|"</span><span class="token punctuation">)</span>
        <span class="token keyword">echo</span> <span class="token string">"NN -&gt; <span class="token variable">$NN</span>"</span>
        <span class="token function">mkdir</span> -p <span class="token variable"><span class="token variable">$(</span><span class="token function">dirname</span> $NN<span class="token variable">)</span></span>
        <span class="token function">mv</span> <span class="token variable">$result</span> <span class="token variable">$NN</span>
<span class="token keyword">done</span>
</code></pre>
<h3 id="se-03-1">26. 2017-SE-03</h3>
<pre class=" language-bash"><code class="prism  language-bash"><span class="token shebang important">#! /bin/bash</span>
<span class="token punctuation">[</span> <span class="token variable"><span class="token variable">$(</span><span class="token function">id</span> -u<span class="token variable">)</span></span> -eq 0 <span class="token punctuation">]</span> <span class="token operator">||</span> <span class="token keyword">exit</span> 1
T<span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span>mktemp<span class="token variable">)</span></span>
<span class="token function">ps</span> --no-headers -e -o user,pid,rss <span class="token operator">&gt;</span> <span class="token variable">$T</span>
uniqueUsers<span class="token operator">=</span><span class="token punctuation">$(</span>awk <span class="token string">'{print <span class="token variable">$1</span>}'</span> <span class="token variable">$T</span> <span class="token operator">|</span> <span class="token function">sort</span> <span class="token operator">|</span> uniq<span class="token punctuation">)</span>
<span class="token keyword">for</span> currUsr <span class="token keyword">in</span> <span class="token variable">$uniqueUsers</span><span class="token punctuation">;</span> <span class="token keyword">do</span>
        usrData<span class="token operator">=</span><span class="token punctuation">$(</span>grep <span class="token string">"<span class="token variable">$currUsr</span>"</span> <span class="token variable">$T</span> <span class="token operator">|</span> <span class="token function">awk</span> <span class="token string">'{sum+=<span class="token variable">$3</span>} END {print <span class="token variable">$1</span> " " NR " " sum}'</span><span class="token punctuation">)</span>
        avgRss<span class="token operator">=</span><span class="token punctuation">$(</span>echo <span class="token variable">$usrData</span> <span class="token operator">|</span> <span class="token function">awk</span> <span class="token string">'{print <span class="token variable">$3</span> / <span class="token variable">$2</span>}'</span><span class="token punctuation">)</span>
        biggestProcess<span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">ps</span> --no-header -u $currUsr -U $currUsr -o pid,rss --sort rss <span class="token operator">|</span> <span class="token function">tail</span> -n 1<span class="token variable">)</span></span>
        biggestPid<span class="token operator">=</span><span class="token punctuation">$(</span>echo <span class="token variable">$biggestProcess</span> <span class="token operator">|</span> <span class="token function">awk</span> <span class="token string">'{print <span class="token variable">$1</span>}'</span><span class="token punctuation">)</span>
        biggestRss<span class="token operator">=</span><span class="token punctuation">$(</span>echo <span class="token variable">$biggestProcess</span> <span class="token operator">|</span> <span class="token function">awk</span> <span class="token string">'{print <span class="token variable">$2</span>}'</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token punctuation">$(</span>echo <span class="token string">"<span class="token variable">${biggestRss}</span> == (<span class="token variable">${avgRss}</span> * 2)"</span> <span class="token operator">|</span> bc<span class="token punctuation">)</span> -eq 1 <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
	            <span class="token function">kill</span> -15 <span class="token variable">$biggestPid</span>
                <span class="token function">sleep</span> 2
                <span class="token function">kill</span> -9 <span class="token variable">$biggestPid</span>
        <span class="token keyword">fi</span>
<span class="token keyword">done</span>
<span class="token function">rm</span> -r <span class="token variable">$T</span>
</code></pre>
<h3 id="se-04-4">27. 2017-SE-04</h3>
<pre class=" language-bash"><code class="prism  language-bash"><span class="token shebang important">#! /bin/bash</span>
<span class="token punctuation">[</span> $<span class="token comment"># -ge 1 ] || exit 1</span>
dirName<span class="token operator">=</span><span class="token variable">$1</span>
fileName<span class="token operator">=</span><span class="token string">""</span>
<span class="token keyword">if</span> <span class="token operator">!</span> <span class="token punctuation">[</span> -z <span class="token variable">$2</span> <span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">then</span>
        fileName<span class="token operator">=</span><span class="token variable">$2</span>
<span class="token keyword">fi</span>
<span class="token comment"># %l - obj %Y - if link is broken</span>
<span class="token keyword">if</span> <span class="token operator">!</span> <span class="token punctuation">[</span> -z <span class="token variable">$fileName</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
        <span class="token function">find</span> <span class="token variable">$dirName</span> -type l -printf <span class="token string">"%p %Y %l\n"</span> <span class="token operator">|</span> <span class="token function">awk</span> <span class="token string">'<span class="token variable">$2</span> == "N" {nonexistentCnt+=1} <span class="token variable">$3</span> != "" {print <span class="token variable">$1</span>,"-&gt;",<span class="token variable">$3</span>} END {print "Broken symlinks:",nonexistentCnt}'</span> <span class="token operator">&gt;</span> <span class="token variable">$fileName</span>
<span class="token keyword">else</span>
        <span class="token function">find</span> <span class="token variable">$dirName</span> -type l -printf <span class="token string">"%p %Y %l\n"</span> <span class="token operator">|</span> <span class="token function">awk</span> <span class="token string">'<span class="token variable">$2</span> == "N" {nonexistentCnt+=1} <span class="token variable">$3</span> != "" {print <span class="token variable">$1</span>,"-&gt;",<span class="token variable">$3</span>} END {print "Broken symlinks:",nonexistentCnt}'</span>
<span class="token keyword">fi</span>
</code></pre>
<h3 id="se-05">28. 2017 -SE-05</h3>
<pre class=" language-bash"><code class="prism  language-bash"><span class="token shebang important">#! /bin/bash</span>
<span class="token punctuation">[</span> $<span class="token comment"># -eq 2 ] || exit 1</span>
D<span class="token operator">=</span><span class="token variable">$1</span>
S<span class="token operator">=</span><span class="token variable">$2</span>
reg<span class="token operator">=</span><span class="token string">"vmlinuz-[0-9]+\.[0-9]+\.[0-9]+-<span class="token variable">${2}</span>"</span>
<span class="token function">find</span> <span class="token variable">$1</span> -maxdepth 1 <span class="token operator">|</span> <span class="token function">egrep</span> <span class="token variable">$reg</span> <span class="token operator">|</span> <span class="token function">rev</span> <span class="token operator">|</span> <span class="token function">cut</span> -d <span class="token string">"/"</span> -f 1 <span class="token operator">|</span> <span class="token function">rev</span> <span class="token operator">|</span> <span class="token function">sed</span> -E <span class="token string">"s/(vmlinuz)-([0-9]+)\.([0-9]+)\.([0-9]+)-([a-zA-Z0-9]+)/\2 \3 \4 \1-\2.\3.\4-\5/"</span> <span class="token operator">|</span> <span class="token function">sort</span> -k 1,1n -k 2,2n -k 3,3n <span class="token operator">|</span> <span class="token function">tail</span> -n 1 <span class="token operator">|</span> <span class="token function">cut</span> -d <span class="token string">" "</span> -f 4
</code></pre>
<h3 id="se-06">29. 2017-SE-06</h3>
<pre class=" language-bash"><code class="prism  language-bash"><span class="token shebang important">#! /bin/bash</span>
<span class="token comment">#[ $(id -u) -eq 0 ] || exit 1</span>
T<span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span>mktemp<span class="token variable">)</span></span>
<span class="token function">ps</span> --no-headers -u root -U root -o user,pid,rss -N <span class="token operator">&gt;</span> <span class="token variable">$T</span>
<span class="token function">cat</span> <span class="token variable">$T</span>
totalRootRSS<span class="token operator">=</span><span class="token punctuation">$(</span>awk <span class="token string">'<span class="token variable">$1</span> == "root" {sum+=<span class="token variable">$3</span>} END {print sum}'</span> <span class="token variable">$T</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token variable"><span class="token variable">$(</span><span class="token function">cat</span> $T<span class="token variable">)</span></span><span class="token punctuation">;</span> <span class="token keyword">do</span>
        iUser<span class="token operator">=</span><span class="token punctuation">$(</span>echo <span class="token variable">$i</span> <span class="token operator">|</span> <span class="token function">cut</span> -d <span class="token string">" "</span> -f 1<span class="token punctuation">)</span>
        iPID<span class="token operator">=</span><span class="token punctuation">$(</span>echo <span class="token variable">$i</span> <span class="token operator">|</span> <span class="token function">cut</span> -d <span class="token string">" "</span> -f 2<span class="token punctuation">)</span>
        iRss<span class="token operator">=</span><span class="token punctuation">$(</span>echo <span class="token variable">$i</span> <span class="token operator">|</span> <span class="token function">cut</span> -d <span class="token string">" "</span> -f 3<span class="token punctuation">)</span>
        iDir<span class="token operator">=</span><span class="token punctuation">$(</span>egrep <span class="token variable">$iUser</span> /etc/passwd <span class="token operator">|</span> <span class="token function">cut</span> -d <span class="token string">":"</span> -f 6<span class="token punctuation">)</span>
        totaliRss<span class="token operator">=</span><span class="token punctuation">$(</span>awk -v targetUsr<span class="token operator">=</span><span class="token variable">$iUser</span> <span class="token string">'<span class="token variable">$1</span> == targetUsr {sum+=<span class="token variable">$3</span>} END {print sum}'</span> <span class="token variable">$T</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> <span class="token punctuation">[</span> -z <span class="token variable">$iDir</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
                <span class="token keyword">echo</span> <span class="token string">"<span class="token variable">$iUser</span> this user has undefined home diretory"</span>
        <span class="token keyword">elif</span> <span class="token operator">!</span> <span class="token punctuation">[</span> -d <span class="token variable">$iDir</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
                <span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token variable">$totalRootRSS</span> -lt <span class="token variable">$totaliRss</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
                        <span class="token keyword">echo</span> <span class="token string">"<span class="token variable">$iUser</span> should stop all their processes"</span>
                        <span class="token comment">#loop over all processes for iUser in $T and kill them</span>
                <span class="token keyword">fi</span>
        <span class="token keyword">elif</span> <span class="token punctuation">[</span> <span class="token string">"$(stat -c "</span>%U<span class="token string">" <span class="token variable">$iDir</span>)"</span> <span class="token operator">!=</span> <span class="token variable">$iUser</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
                <span class="token keyword">echo</span> <span class="token string">"<span class="token variable">$iUser</span> isnt the owner of the directory"</span>
                <span class="token comment">#repeat same as row 15</span>
        <span class="token keyword">elif</span> <span class="token punctuation">[</span> <span class="token string">"$(stat -c "</span>%A<span class="token string">" <span class="token variable">$iDir</span> | cut -c 3)"</span> <span class="token operator">!=</span> <span class="token string">"w"</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
                <span class="token keyword">echo</span> <span class="token string">"<span class="token variable">$iUser</span> cannot write in their own directory"</span>
                <span class="token comment">#repeat same as row 15</span>
        <span class="token keyword">fi</span>
<span class="token keyword">done</span>
<span class="token function">rm</span> -r <span class="token variable">$T</span>
</code></pre>
<h3 id="se-03-2">32. 2018-SE-03</h3>
<pre class=" language-bash"><code class="prism  language-bash"><span class="token shebang important">#! /bin/bash</span>
<span class="token function">sort</span> -t <span class="token string">','</span> -k 2 -k 1,1n <span class="token operator">|</span> <span class="token function">sed</span> -E <span class="token string">"s/,/\t/"</span> <span class="token operator">|</span> <span class="token function">uniq</span> -f 1 <span class="token operator">|</span> <span class="token function">tr</span> <span class="token string">'\t'</span> <span class="token string">','</span> 
</code></pre>
<h3 id="se-01-2">33. 2019-SE-01</h3>
<pre class=" language-bash"><code class="prism  language-bash">a<span class="token punctuation">)</span>
<span class="token comment">#! /bin/bash</span>
reg<span class="token operator">=</span><span class="token string">'^(-|)[0-9]+$'</span>
myMax<span class="token operator">=</span>0
T<span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span>mktemp<span class="token variable">)</span></span>
<span class="token keyword">while</span> <span class="token function">read</span> row<span class="token punctuation">;</span> <span class="token keyword">do</span>
        <span class="token keyword">echo</span> <span class="token variable">$row</span>
        <span class="token keyword">if</span> <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token variable">$row</span> <span class="token operator">=</span>~ ^<span class="token punctuation">(</span>-<span class="token operator">|</span><span class="token punctuation">)</span><span class="token punctuation">[</span>0-9<span class="token punctuation">]</span>+$ <span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
                <span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token variable">$myMax</span> -lt <span class="token variable">$row</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
                        myMax<span class="token operator">=</span><span class="token variable">$row</span>
                <span class="token keyword">fi</span>
        <span class="token keyword">fi</span>
<span class="token keyword">done</span> <span class="token operator">&gt;</span> <span class="token variable">$T</span>
<span class="token function">egrep</span> <span class="token string">"<span class="token variable">$myMax</span>"</span> <span class="token variable">$T</span> <span class="token operator">|</span> <span class="token function">sort</span> <span class="token operator">|</span> <span class="token function">uniq</span>
<span class="token function">rm</span> -r <span class="token variable">$T</span>
</code></pre>
<h3 id="se">34. 2019-SE</h3>
<pre class=" language-bash"><code class="prism  language-bash"><span class="token shebang important">#! /bin/bash</span>

<span class="token punctuation">[</span> $<span class="token comment"># -ge 1 ] || exit 1</span>
N<span class="token operator">=</span>10
<span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token variable">$1</span> <span class="token operator">==</span> <span class="token string">"-n"</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
		<span class="token punctuation">[</span> $<span class="token comment"># -ge 2 ] || exit 2</span>
        N<span class="token operator">=</span><span class="token variable">$2</span>
        <span class="token function">shift</span> 2 
<span class="token keyword">fi</span>

<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token variable">$@</span><span class="token punctuation">;</span> <span class="token keyword">do</span>
        IDF<span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">basename</span> -s .log $i<span class="token variable">)</span></span>
        <span class="token comment">#tail -n $N $i | $sed -E "s/ /@/2" | awk -F "@" -v idfTitle=$IDF '{print $1, idfTitle, $2}'</span>
        <span class="token function">tail</span> -n <span class="token variable">$N</span> <span class="token variable">$F</span> <span class="token operator">|</span> <span class="token function">sed</span> -E <span class="token string">"s/^(.{19}) (.*)$/\1 <span class="token variable">$IDF</span> \2/"</span> <span class="token comment"># better way</span>
<span class="token keyword">done</span> <span class="token operator">|</span> <span class="token function">sort</span> -t <span class="token string">" "</span> -k 1,2
</code></pre>
<h3 id="se-03-3">35. 2019-SE-03</h3>
<pre class=" language-bash"><code class="prism  language-bash"><span class="token shebang important">#! /bin/bash</span>

<span class="token punctuation">[</span> $<span class="token comment"># -eq 1 ] || exit 1</span>
<span class="token punctuation">[</span> -d <span class="token variable">$1</span> <span class="token punctuation">]</span> <span class="token operator">||</span> <span class="token keyword">exit</span> 2
<span class="token keyword">if</span> <span class="token operator">!</span> <span class="token punctuation">[</span> -d ./extracted <span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">then</span>
        <span class="token function">mkdir</span> extracted
<span class="token keyword">fi</span>

DIR<span class="token operator">=</span><span class="token variable">$1</span>

<span class="token keyword">for</span> archive <span class="token keyword">in</span> <span class="token punctuation">$(</span>find <span class="token variable">$DIR</span> -name <span class="token string">"*.tgz"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">do</span>
        archiveName<span class="token operator">=</span><span class="token punctuation">$(</span>basename -s .tgz <span class="token variable">$archive</span> <span class="token operator">|</span> <span class="token function">cut</span> -d <span class="token string">"_"</span> -f 1<span class="token punctuation">)</span>
        archiveTimeStamp<span class="token operator">=</span><span class="token punctuation">$(</span>basename -s .tgz <span class="token variable">$archive</span> <span class="token operator">|</span> <span class="token function">rev</span> <span class="token operator">|</span> <span class="token function">cut</span> -d <span class="token string">"-"</span> -f 1 <span class="token operator">|</span> rev<span class="token punctuation">)</span>
        <span class="token keyword">for</span> target <span class="token keyword">in</span> <span class="token punctuation">$(</span>tar -tf <span class="token variable">$archive</span> <span class="token operator">|</span> <span class="token function">grep</span> <span class="token string">"meow.txt"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">do</span>
                <span class="token function">tar</span> -xf <span class="token variable">$archive</span> -C ./extracted <span class="token variable">$target</span>
                <span class="token function">mv</span> ./extracted/<span class="token variable">$target</span> ./extracted/<span class="token variable">${archiveName}</span>_<span class="token variable">${archiveTimeStamp}</span>.txt
        <span class="token keyword">done</span>
<span class="token keyword">done</span>
</code></pre>
<h3 id="se-01-3">36. 2020-SE-01</h3>
<pre class=" language-bash"><code class="prism  language-bash"><span class="token shebang important">#! /bin/bash</span>

<span class="token punctuation">[</span> $<span class="token comment"># -eq 2 ] || exit 1</span>
<span class="token punctuation">[</span> -f <span class="token variable">$1</span> <span class="token punctuation">]</span> <span class="token operator">||</span> <span class="token keyword">exit</span> 2
<span class="token punctuation">[</span> -d <span class="token variable">$2</span> <span class="token punctuation">]</span> <span class="token operator">||</span> <span class="token keyword">exit</span> 3

file<span class="token operator">=</span><span class="token variable">$1</span>
dir<span class="token operator">=</span><span class="token variable">$2</span>

<span class="token keyword">echo</span> -e <span class="token string">"hostname,phy,vlans,hosts,failover,VPN-3DES-AES,peers,VLAN Trunk Ports,license,SN,key"</span> <span class="token operator">&gt;</span> <span class="token variable">$file</span>
<span class="token keyword">for</span> logFile <span class="token keyword">in</span> <span class="token punctuation">$(</span>find <span class="token variable">$dir</span> -name <span class="token string">"*.log"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">do</span>
        <span class="token keyword">echo</span> -n <span class="token string">"<span class="token variable"><span class="token variable">$(</span><span class="token function">basename</span> -s .log $logFile<span class="token variable">)</span></span>,"</span> <span class="token operator">&gt;&gt;</span> <span class="token variable">$file</span>
        <span class="token keyword">echo</span> <span class="token punctuation">$(</span>grep <span class="token string">"^[^\n]"</span> <span class="token variable">$logFile</span> <span class="token operator">|</span> <span class="token function">tail</span> -n +2 <span class="token operator">|</span> <span class="token function">sed</span> -E <span class="token string">"s/ +/ /g"</span> <span class="token operator">|</span> <span class="token function">sed</span> -E <span class="token string">"s/[^:]*: (.*)/\1/"</span> <span class="token operator">|</span> <span class="token function">sed</span> -E <span class="token string">"s/This platform has a (.*) license./\1/"</span> <span class="token operator">|</span> <span class="token function">tr</span> <span class="token string">"\n"</span> <span class="token string">","</span> <span class="token operator">|</span> <span class="token function">sed</span> -E <span class="token string">"s/,//10"</span><span class="token punctuation">)</span> <span class="token operator">&gt;&gt;</span> <span class="token variable">$file</span>
<span class="token keyword">done</span>
</code></pre>
<h3 id="se-02-2">37. 2020-SE-02</h3>
<pre class=" language-bash"><code class="prism  language-bash"><span class="token shebang important">#! /bin/bash</span>
<span class="token punctuation">[</span> $<span class="token comment"># -eq 1 ] || exit 1</span>
<span class="token punctuation">[</span> -f <span class="token variable">$1</span> <span class="token punctuation">]</span> <span class="token operator">||</span> <span class="token keyword">exit</span> 2
file<span class="token operator">=</span><span class="token variable">$1</span>
<span class="token keyword">for</span> client <span class="token keyword">in</span> <span class="token punctuation">$(</span>awk <span class="token string">'{print <span class="token variable">$2</span>}'</span> <span class="token variable">$file</span> <span class="token operator">|</span> <span class="token function">sort</span> -k 1,1 <span class="token operator">|</span> <span class="token function">uniq</span> -c <span class="token operator">|</span> <span class="token function">sort</span> -k 1,1n <span class="token operator">|</span> <span class="token function">tail</span> -n 3 <span class="token operator">|</span> <span class="token function">awk</span> <span class="token string">'{print <span class="token variable">$2</span>}'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">do</span>
        <span class="token keyword">echo</span> <span class="token string">"<span class="token variable">$client</span> HTTP/2.0: $(grep <span class="token variable">$client</span> <span class="token variable">$file</span> | grep "</span>HTTP/2.0<span class="token string">" | wc -l) non-HTTP/2.0: $(grep <span class="token variable">$client</span> <span class="token variable">$file</span> | grep -v "</span>HTTP/2.0<span class="token string">" | wc -l)"</span>
<span class="token keyword">done</span>
<span class="token keyword">for</span> ipAdress <span class="token keyword">in</span> <span class="token punctuation">$(</span>awk <span class="token string">'<span class="token variable">$9</span> &gt; 302 {print <span class="token variable">$1</span>}'</span> <span class="token variable">$file</span> <span class="token operator">|</span> <span class="token function">sort</span> -k 1,1 <span class="token operator">|</span> <span class="token function">uniq</span> -c <span class="token operator">|</span> <span class="token function">sort</span> -k 1,1n <span class="token operator">|</span> <span class="token function">tail</span> -n 5 <span class="token operator">|</span> <span class="token function">awk</span> <span class="token string">'{print <span class="token variable">$2</span>}'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">do</span>
        <span class="token keyword">echo</span> <span class="token string">"<span class="token variable"><span class="token variable">$(</span><span class="token function">grep</span> $ipAdress $file <span class="token operator">|</span> <span class="token function">awk</span> '$9 <span class="token operator">&gt;</span> 302 <span class="token punctuation">{</span>print $1<span class="token punctuation">}</span>' <span class="token operator">|</span> <span class="token function">wc</span> -l<span class="token variable">)</span></span> <span class="token variable">$ipAdress</span>"</span>
<span class="token keyword">done</span>
</code></pre>
<h3 id="se-03-4">38. 2020-SE-03</h3>
<pre class=" language-bash"><code class="prism  language-bash"><span class="token shebang important">#!/bin/bash</span>
<span class="token punctuation">[</span> $<span class="token comment"># -eq 2 ] || exit 1</span>
repo<span class="token operator">=</span><span class="token variable">$1</span><span class="token punctuation">;</span> package<span class="token operator">=</span><span class="token variable">$2</span><span class="token punctuation">;</span> packageName<span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">basename</span> $package<span class="token variable">)</span></span><span class="token punctuation">;</span> packageVersion<span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">cat</span> $package/version<span class="token variable">)</span></span>
<span class="token function">tar</span> -cf <span class="token variable">$packageName</span>.tar <span class="token variable">$package</span>/tree
xz <span class="token variable">$packageName</span>.tar
sha<span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span>sha256sum <span class="token operator">&lt;</span><span class="token punctuation">(</span>echo $packageName.tar.xz<span class="token variable">)</span></span> <span class="token operator">|</span> <span class="token function">cut</span> -d <span class="token string">' '</span> -f 1<span class="token punctuation">)</span>
<span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token punctuation">$(</span>egrep -c <span class="token string">"<span class="token variable">$packageVersion</span>"</span> <span class="token variable">$repo</span>/db<span class="token punctuation">)</span> -ne 0 <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
    R<span class="token operator">=</span><span class="token punctuation">$(</span>sed -e <span class="token string">"s/.*<span class="token variable">$packageVersion</span>.*//"</span> <span class="token variable">$repo</span>/db <span class="token operator">|</span> <span class="token function">tr</span> -s <span class="token string">'\n'</span><span class="token punctuation">)</span>
    <span class="token function">rm</span> <span class="token variable">$repo</span>/packages/<span class="token punctuation">$(</span>egrep <span class="token string">"<span class="token variable">$packageVersion</span>"</span> <span class="token variable">$repo</span>/db <span class="token operator">|</span> <span class="token function">cut</span> -d <span class="token string">' '</span> -f 2<span class="token punctuation">)</span>.tar.xz
    <span class="token keyword">echo</span> <span class="token string">"<span class="token variable">$R</span>"</span> <span class="token operator">&gt;</span> <span class="token variable">$repo</span>/db
<span class="token keyword">fi</span>
<span class="token function">mv</span> <span class="token variable">$packageName</span>.tar.xz <span class="token variable">$repo</span>/packages/<span class="token variable">$sha</span>.tar.xz
<span class="token keyword">echo</span> <span class="token string">"<span class="token variable">$packageName</span>-<span class="token variable">$packageVersion</span> <span class="token variable">$sha</span>"</span> <span class="token operator">&gt;&gt;</span> <span class="token variable">$repo</span>/db
<span class="token keyword">echo</span> <span class="token string">"<span class="token variable"><span class="token variable">$(</span><span class="token function">sort</span> $repo/db<span class="token variable">)</span></span>"</span> <span class="token operator">&gt;</span> <span class="token variable">$repo</span>/db
</code></pre>
<h3 id="se-04-5">39. 2020-SE-04</h3>
<pre class=" language-bash"><code class="prism  language-bash"><span class="token shebang important">#! /bin/bash</span>
<span class="token punctuation">[</span> $<span class="token comment"># -eq 2 ] || exit 1</span>
<span class="token punctuation">[</span> -d <span class="token variable">$1</span> <span class="token punctuation">]</span> <span class="token operator">||</span> <span class="token keyword">exit</span> 2
SRC<span class="token operator">=</span><span class="token variable">$1</span>
DST<span class="token operator">=</span><span class="token variable">$2</span>
<span class="token keyword">echo</span> <span class="token string">"<span class="token variable">$DST</span>"</span>
<span class="token function">mkdir</span> -p <span class="token variable">$DST</span>/images
<span class="token keyword">for</span> image <span class="token keyword">in</span> <span class="token punctuation">$(</span>find <span class="token variable">$SRC</span> -name <span class="token string">"*.jpg"</span> <span class="token operator">|</span> <span class="token function">sed</span> -E <span class="token string">"s/ /-/g"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">do</span>
    fileName<span class="token operator">=</span><span class="token punctuation">$(</span>echo <span class="token string">"<span class="token variable">$image</span>"</span> <span class="token operator">|</span> <span class="token function">sed</span> -E <span class="token string">"s/-/ /g"</span><span class="token punctuation">)</span>
    title<span class="token operator">=</span><span class="token punctuation">$(</span>basename -s .jpg <span class="token string">"<span class="token variable">$fileName</span>"</span> <span class="token operator">|</span> <span class="token function">sed</span> -E <span class="token string">"s/\([^()]*\)//g"</span> <span class="token operator">|</span> <span class="token function">sed</span> -E <span class="token string">"s/ +/ /g"</span> <span class="token operator">|</span> <span class="token function">sed</span> -E <span class="token string">"s/ *$//g"</span><span class="token punctuation">)</span>
    album<span class="token operator">=</span><span class="token string">""</span>
    <span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token punctuation">$(</span>echo <span class="token string">"<span class="token variable">$fileName</span>"</span> <span class="token operator">|</span> <span class="token function">egrep</span> -c <span class="token string">"\(.*\)"</span><span class="token punctuation">)</span> -eq 0 <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
            album<span class="token operator">=</span><span class="token string">"misc"</span>
    <span class="token keyword">else</span>
            album<span class="token operator">=</span><span class="token punctuation">$(</span>basename -s .jpg <span class="token string">"<span class="token variable">$fileName</span>"</span> <span class="token operator">|</span> <span class="token function">sed</span> -E <span class="token string">"s/.*\(([^()]*)\).*/\1/"</span><span class="token punctuation">)</span>
    <span class="token keyword">fi</span>
    lastModif<span class="token operator">=</span><span class="token punctuation">$(</span>date -d @<span class="token punctuation">$(</span>stat -c <span class="token string">"%Y"</span> <span class="token string">"<span class="token variable">$fileName</span>"</span><span class="token punctuation">)</span> +<span class="token string">"%Y-%m-%d"</span><span class="token punctuation">)</span>
       sha16<span class="token operator">=</span><span class="token punctuation">$(</span>sha256sum <span class="token string">"<span class="token variable">$fileName</span>"</span> <span class="token operator">|</span> <span class="token function">cut</span> -c -16<span class="token punctuation">)</span>

       shaFileName<span class="token operator">=</span><span class="token string">"<span class="token variable">$DST</span>/images/<span class="token variable">${sha16}</span>.jpg"</span>
       <span class="token function">cp</span> <span class="token string">"<span class="token variable">$fileName</span>"</span> <span class="token variable">$shaFileName</span>

       dateAlbumTitle<span class="token operator">=</span><span class="token string">"<span class="token variable">$DST</span>/by-date/<span class="token variable">$lastModif</span>/by-album/<span class="token variable">$album</span>/by-title"</span>
       dateTitle<span class="token operator">=</span><span class="token string">"<span class="token variable">$DST</span>/by-date/<span class="token variable">$lastModif</span>/by-title"</span>
       albumDateTitle<span class="token operator">=</span><span class="token string">"<span class="token variable">$DST</span>/by-album/<span class="token variable">$album</span>/by-date/<span class="token variable">$lastModif</span>/by-title"</span>
       albumTitle<span class="token operator">=</span><span class="token string">"<span class="token variable">$DST</span>/by-album/<span class="token variable">$album</span>/by-title"</span>
       titleDir<span class="token operator">=</span><span class="token string">"<span class="token variable">$DST</span>/by-title"</span>
       <span class="token function">mkdir</span> -p <span class="token variable">$dateAlbumTitle</span> 2<span class="token operator">&gt;</span> /dev/null
       <span class="token function">mkdir</span> -p <span class="token variable">$dateTitle</span> 2<span class="token operator">&gt;</span> /dev/null
       <span class="token function">mkdir</span> -p <span class="token variable">$albumDateTitle</span> 2<span class="token operator">&gt;</span> /dev/null
       <span class="token function">mkdir</span> -p <span class="token variable">$albumTitle</span> 2<span class="token operator">&gt;</span> /dev/null
       <span class="token function">mkdir</span> -p <span class="token variable">$titleDir</span> 2<span class="token operator">&gt;</span> /dev/null

       <span class="token function">cp</span> -s <span class="token variable">$shaFileName</span> <span class="token string">"<span class="token variable">${dateAlbumTitle}</span>/<span class="token variable">${title}</span>.jpg"</span>
       <span class="token function">cp</span> -s <span class="token variable">$shaFileName</span> <span class="token string">"<span class="token variable">${dateTitle}</span>/<span class="token variable">${title}</span>.jpg"</span>
       <span class="token function">cp</span> -s <span class="token variable">$shaFileName</span> <span class="token string">"<span class="token variable">${albumDateTitle}</span>/<span class="token variable">${title}</span>.jpg"</span>
       <span class="token function">cp</span> -s <span class="token variable">$shaFileName</span> <span class="token string">"<span class="token variable">${albumTitle}</span>/<span class="token variable">${title}</span>.jpg"</span>
       <span class="token function">cp</span> -s <span class="token variable">$shaFileName</span> <span class="token string">"<span class="token variable">${titleDir}</span>/<span class="token variable">${title}</span>.jpg"</span>
<span class="token keyword">done</span>
</code></pre>
<h3 id="se-05-1">40. 2020-SE-05</h3>
<pre class=" language-bash"><code class="prism  language-bash"><span class="token shebang important">#! /bin/bash</span>

<span class="token punctuation">[</span> $<span class="token comment"># -eq 3 ] || exit 1</span>
<span class="token punctuation">[</span> -d <span class="token variable">$3</span> <span class="token punctuation">]</span> <span class="token operator">||</span> <span class="token keyword">exit</span> 2

pwdFile<span class="token operator">=</span><span class="token variable">$1</span>
configFile<span class="token operator">=</span><span class="token variable">$2</span>
dir<span class="token operator">=</span><span class="token variable">$3</span>

<span class="token keyword">for</span> cfg <span class="token keyword">in</span> <span class="token punctuation">$(</span>find <span class="token variable">$dir</span> -name <span class="token string">"*.cfg"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">do</span>
        hasErrors<span class="token operator">=</span><span class="token punctuation">$(</span>awk <span class="token string">'<span class="token variable">$0</span> !~ /(^# .*)|({ [0-9a-zA-Z;-]+ };)|(^\s*$)/ {print "Line",NR ":" <span class="token variable">$0</span>}'</span> <span class="token variable">${cfg}</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> <span class="token operator">!</span> <span class="token punctuation">[</span> -z <span class="token string">"<span class="token variable">${hasErrors}</span>"</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
                <span class="token keyword">echo</span> <span class="token string">"Error in <span class="token variable"><span class="token variable">$(</span><span class="token function">basename</span> $<span class="token punctuation">{</span>cfg<span class="token punctuation">}</span><span class="token variable">)</span></span>:"</span>
                <span class="token keyword">echo</span> <span class="token string">"<span class="token variable">${hasErrors}</span>"</span>
        <span class="token keyword">else</span>
                userName<span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">basename</span> -s .cfg $cfg<span class="token variable">)</span></span>
                isContained<span class="token operator">=</span><span class="token punctuation">$(</span>egrep -c <span class="token string">"^<span class="token variable">${userName}</span>:"</span> <span class="token variable">$pwdFile</span><span class="token punctuation">)</span>
                <span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token variable">$isContained</span> -eq 0 <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
                        pass<span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span>pwgen 16 1<span class="token variable">)</span></span>
                        info<span class="token operator">=</span><span class="token string">"<span class="token variable"><span class="token variable">$(</span><span class="token function">basename</span> -s .cfg $cfg<span class="token variable">)</span></span> <span class="token variable">$pass</span>"</span>
                        <span class="token keyword">echo</span> <span class="token string">"<span class="token variable">$info</span>"</span> <span class="token operator">|</span> <span class="token function">sed</span> -E <span class="token string">"s/ /:/"</span> <span class="token operator">&gt;&gt;</span> <span class="token variable">$pwdFile</span>
                        <span class="token keyword">echo</span> <span class="token string">"<span class="token variable">$info</span>"</span>
                <span class="token keyword">fi</span>
                <span class="token function">cat</span> <span class="token variable">$cfg</span> <span class="token operator">&gt;&gt;</span> <span class="token variable">$configFile</span>
        <span class="token keyword">fi</span>
<span class="token keyword">done</span>
</code></pre>
<h3 id="se-06-1">41. 2020-SE-06</h3>
<pre class=" language-bash"><code class="prism  language-bash"><span class="token shebang important">#! /bin/bash</span>
<span class="token punctuation">[</span> $<span class="token comment"># -eq 3 ] || exit 1</span>
src<span class="token operator">=</span><span class="token variable">$1</span>
key<span class="token operator">=</span><span class="token variable">$2</span>
val<span class="token operator">=</span><span class="token variable">$3</span>
currUser<span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">id</span> -u<span class="token variable">)</span></span>
currDate<span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">date</span><span class="token variable">)</span></span>
<span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token punctuation">$(</span>egrep -c <span class="token string">" *<span class="token variable">${key}</span> *="</span> <span class="token variable">$src</span><span class="token punctuation">)</span> -eq 0 <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
        <span class="token keyword">echo</span> <span class="token string">"<span class="token variable">$key</span> = <span class="token variable">$val</span> # added at <span class="token variable">$currDate</span> by <span class="token variable">$currUser</span>"</span> <span class="token operator">&gt;&gt;</span> <span class="token variable">$src</span>
<span class="token keyword">else</span>
        <span class="token function">sed</span> -i -E <span class="token string">"s/( *<span class="token variable">${key}</span> *= *.+)/# \1 # edited at <span class="token variable">${currDate}</span> by <span class="token variable">${currUser}</span>\n<span class="token variable">${key}</span> = <span class="token variable">${val}</span> # added at <span class="token variable">${currDate}</span> by <span class="token variable">${currUser}</span>/"</span> <span class="token variable">$src</span>
<span class="token keyword">fi</span>
</code></pre>
<h3 id="se-02-3">43. 2021-SE-02</h3>
<pre class=" language-bash"><code class="prism  language-bash"><span class="token shebang important">#! /bin/bash</span>

<span class="token punctuation">[</span> $<span class="token comment"># -gt 0 ] || exit 1</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token variable">$@</span><span class="token punctuation">;</span> <span class="token keyword">do</span>
        <span class="token punctuation">[</span> -f <span class="token variable">$i</span> <span class="token punctuation">]</span> <span class="token operator">||</span> <span class="token keyword">exit</span> 2
<span class="token keyword">done</span>

<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token variable">$@</span><span class="token punctuation">;</span> <span class="token keyword">do</span>
        <span class="token punctuation">[</span> <span class="token punctuation">$(</span>head -n 1 <span class="token variable">$i</span> <span class="token operator">|</span> <span class="token function">grep</span> <span class="token string">"SOA"</span> <span class="token operator">|</span> <span class="token function">wc</span> -l<span class="token punctuation">)</span> -eq 1 <span class="token punctuation">]</span> <span class="token operator">||</span> <span class="token punctuation">(</span>echo <span class="token string">"File <span class="token variable">${i}</span>'s first row doesn't contain SOA"</span> <span class="token operator">&amp;&amp;</span> continue<span class="token punctuation">)</span>
        fields<span class="token operator">=</span>11
        todaysDate<span class="token operator">=</span><span class="token punctuation">$(</span>date +<span class="token string">"%Y%m%d"</span><span class="token punctuation">)</span>
        newDateSOA<span class="token operator">=</span><span class="token string">"$(date +"</span>%Y%m%d<span class="token string">")00"</span>
        <span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token punctuation">$(</span>head -n 1 <span class="token variable">$i</span> <span class="token operator">|</span> <span class="token function">grep</span> <span class="token string">"("</span> <span class="token operator">|</span> <span class="token function">wc</span> -l <span class="token punctuation">)</span> -eq 1 <span class="token punctuation">]</span> <span class="token punctuation">;</span><span class="token keyword">then</span>
                serialNum<span class="token operator">=</span><span class="token punctuation">$(</span>echo <span class="token punctuation">$(</span>grep <span class="token string">"serial"</span> <span class="token variable">$i</span> <span class="token operator">|</span> <span class="token function">awk</span> -F <span class="token string">";"</span> <span class="token string">'{print <span class="token variable">$1</span>}'</span><span class="token punctuation">))</span>
                timeOnly<span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token keyword">echo</span> $serialNum <span class="token operator">|</span> <span class="token function">cut</span> -c -8<span class="token variable">)</span></span>
                changesOnly<span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token keyword">echo</span> $serialNum <span class="token operator">|</span> <span class="token function">cut</span> -c 9-<span class="token variable">)</span></span>
                <span class="token keyword">if</span> <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token string">"<span class="token variable">$todaysDate</span>"</span> <span class="token operator">&gt;</span> <span class="token string">"<span class="token variable">$timeOnly</span>"</span> <span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
                        <span class="token function">sed</span> -i -E <span class="token string">"s/<span class="token variable">$serialNum</span>/<span class="token variable">$newDateSOA</span>/g"</span> <span class="token variable">$i</span>
                <span class="token keyword">elif</span> <span class="token punctuation">[</span> <span class="token string">"<span class="token variable">$todaysDate</span>"</span> <span class="token operator">=</span> <span class="token string">"<span class="token variable">$timeOnly</span>"</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
                        newChanges<span class="token operator">=</span><span class="token variable"><span class="token variable">$((</span> $changesOnly <span class="token operator">+</span> <span class="token number">1</span> <span class="token variable">))</span></span>
                        <span class="token punctuation">[</span> <span class="token variable">$newChanges</span> -gt 99 <span class="token punctuation">]</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">echo</span> <span class="token string">"Cannot exceed 99 changes per day!"</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">continue</span>
                        <span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token variable">$newChanges</span> -lt 10 <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
                                newDate<span class="token operator">=</span><span class="token punctuation">$(</span>echo <span class="token string">"<span class="token variable">${timeOnly}</span>0<span class="token variable">${newChanges}</span>"</span><span class="token punctuation">)</span>
                                <span class="token function">sed</span> -i -E <span class="token string">"s/<span class="token variable">$serialNum</span>/<span class="token variable">$newDate</span>/g"</span> <span class="token variable">$i</span>
                        <span class="token keyword">else</span>
                                newDate<span class="token operator">=</span><span class="token punctuation">$(</span>echo <span class="token string">"<span class="token variable">${timeOnly}</span><span class="token variable">${newChanges}</span>"</span><span class="token punctuation">)</span>
                                <span class="token function">sed</span> -i -E <span class="token string">"s/<span class="token variable">$serialNum</span>/<span class="token variable">$newDate</span>/g"</span> <span class="token variable">$i</span>
                        <span class="token keyword">fi</span>
                <span class="token keyword">fi</span>
        <span class="token keyword">else</span>
                <span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token punctuation">$(</span>head -n 1 <span class="token variable">$i</span> <span class="token operator">|</span> <span class="token function">awk</span> <span class="token string">'{print NF}'</span><span class="token punctuation">)</span> -eq 10 <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
                        fields<span class="token operator">=</span>10
                <span class="token keyword">fi</span>
                whereToPutDash<span class="token operator">=</span><span class="token variable"><span class="token variable">$((</span>$fields <span class="token operator">-</span> <span class="token number">7</span><span class="token variable">))</span></span>
                divided<span class="token operator">=</span><span class="token punctuation">$(</span>head -n 1 <span class="token variable">$i</span> <span class="token operator">|</span> <span class="token function">sed</span> -E <span class="token string">"s/ /-/<span class="token variable">$whereToPutDash</span>"</span><span class="token punctuation">)</span>
                timeStamp<span class="token operator">=</span><span class="token punctuation">$(</span>echo <span class="token variable">$divided</span> <span class="token operator">|</span> <span class="token function">awk</span> -F <span class="token string">"-"</span> <span class="token string">'{print <span class="token variable">$2</span>}'</span> <span class="token operator">|</span> <span class="token function">awk</span> <span class="token string">'{print <span class="token variable">$3</span>}'</span><span class="token punctuation">)</span> <span class="token comment"># 2022101099</span>
                timeOnly<span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token keyword">echo</span> $timeStamp <span class="token operator">|</span> <span class="token function">cut</span> -c -8<span class="token variable">)</span></span> <span class="token comment"># 20221010</span>
                changesOnly<span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token keyword">echo</span> $timeStamp <span class="token operator">|</span> <span class="token function">cut</span> -c 9-<span class="token variable">)</span></span> <span class="token comment"># 99</span>
                   <span class="token keyword">if</span> <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token string">"<span class="token variable">$todaysDate</span>"</span> <span class="token operator">&gt;</span> <span class="token string">"<span class="token variable">$timeOnly</span>"</span> <span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span> <span class="token comment">#[ $(date +"%s") -gt $(date -d "$timeOnly" +"%s") ]; then</span>
                       <span class="token function">sed</span> -i -E <span class="token string">"s/<span class="token variable">$timeStamp</span>/<span class="token variable">$newDateSOA</span>/g"</span> <span class="token variable">$i</span>
                   <span class="token keyword">elif</span> <span class="token punctuation">[</span> <span class="token string">"<span class="token variable">$todaysDate</span>"</span> <span class="token operator">=</span> <span class="token string">"<span class="token variable">$timeOnly</span>"</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
                       newChanges<span class="token operator">=</span><span class="token variable"><span class="token variable">$((</span> $changesOnly <span class="token operator">+</span> <span class="token number">1</span> <span class="token variable">))</span></span>
                       <span class="token punctuation">[</span> <span class="token variable">$newChanges</span> -gt 99 <span class="token punctuation">]</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">echo</span> <span class="token string">"Cannot exceed 99 changes per day!"</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">continue</span>
                       <span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token variable">$newChanges</span> -lt 10 <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
                               newDate<span class="token operator">=</span><span class="token punctuation">$(</span>echo <span class="token string">"<span class="token variable">${timeOnly}</span>0<span class="token variable">${newChanges}</span>"</span><span class="token punctuation">)</span>
                               <span class="token function">sed</span> -i -E <span class="token string">"s/<span class="token variable">$timeStamp</span>/<span class="token variable">$newDate</span>/g"</span> <span class="token variable">$i</span>
                   <span class="token keyword">else</span>
                               newDate<span class="token operator">=</span><span class="token punctuation">$(</span>echo <span class="token string">"<span class="token variable">${timeOnly}</span><span class="token variable">${newChanges}</span>"</span><span class="token punctuation">)</span>
                               <span class="token function">sed</span> -i -E <span class="token string">"s/<span class="token variable">$timeStamp</span>/<span class="token variable">$newDate</span>/g"</span> <span class="token variable">$i</span>
                   <span class="token keyword">fi</span>
               <span class="token keyword">fi</span>
       <span class="token keyword">fi</span>
<span class="token keyword">done</span>
</code></pre>
<h3 id="se-03-5">44. 2021-SE-03</h3>
<pre class=" language-bash"><code class="prism  language-bash">	<span class="token comment">#! /bin/bash</span>
	<span class="token punctuation">[</span> $<span class="token comment"># -eq 2 ] || (echo "insufficient args" &amp;&amp; exit 1)</span>
	INPUT<span class="token operator">=</span><span class="token variable">$1</span>
	OUTPUT<span class="token operator">=</span><span class="token variable">$2</span>
	numbers<span class="token operator">=</span><span class="token punctuation">$(</span>hexdump <span class="token variable">$INPUT</span> <span class="token operator">|</span> <span class="token function">awk</span> <span class="token string">'{ s = ""; for (i = 2; i &lt;= NF; i++) s = s <span class="token variable">$i</span> " "; print s }'</span><span class="token punctuation">)</span>
	outputTextArr<span class="token operator">=</span><span class="token string">"const uin16_t arr={"</span>
	count<span class="token operator">=</span>0
	<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token variable">$numbers</span><span class="token punctuation">;</span> <span class="token keyword">do</span>
	        littleEnd<span class="token operator">=</span><span class="token punctuation">$(</span>echo <span class="token variable">$i</span> <span class="token operator">|</span> <span class="token function">sed</span> -E <span class="token string">"s/(..)(..)/\2\1/g"</span> <span class="token operator">|</span> <span class="token function">tr</span> <span class="token string">'[a-z]'</span> <span class="token string">'[A-Z]'</span><span class="token punctuation">)</span>
	        toDec<span class="token operator">=</span><span class="token punctuation">$(</span>echo <span class="token string">"obase=10; ibase=16; <span class="token variable">$littleEnd</span>"</span> <span class="token operator">|</span> bc<span class="token punctuation">)</span>
	        outputTextArr<span class="token operator">=</span><span class="token punctuation">$(</span>echo <span class="token string">"<span class="token variable">${outputTextArr}</span> <span class="token variable">${toDec}</span>,"</span><span class="token punctuation">)</span>
	        count<span class="token operator">=</span><span class="token variable"><span class="token variable">$((</span>$count <span class="token operator">+</span> <span class="token number">1</span><span class="token variable">))</span></span>
	<span class="token keyword">done</span>
	outputTextArr<span class="token operator">=</span><span class="token punctuation">$(</span>echo <span class="token string">"<span class="token variable"><span class="token variable">$(</span><span class="token keyword">echo</span> $outputTextArr <span class="token operator">|</span> <span class="token function">rev</span> <span class="token operator">|</span> <span class="token function">cut</span> -c 2- <span class="token operator">|</span> <span class="token function">rev</span><span class="token variable">)</span></span>};"</span><span class="token punctuation">)</span>
	outputSizeArr<span class="token operator">=</span><span class="token string">"uint32_t arrN=<span class="token variable">$count</span>"</span>
	<span class="token keyword">echo</span> -e <span class="token string">"<span class="token variable">${outputTextArr}</span>\n<span class="token variable">$outputSizeArr</span>"</span> <span class="token operator">&gt;</span> <span class="token variable">$OUTPUT</span>
</code></pre>
<h3 id="ce-01">46. 2022-CE-01</h3>
<pre class=" language-bash"><code class="prism  language-bash">	<span class="token comment">#! /bin/bash</span>

	baseCSV<span class="token operator">=</span><span class="token string">"base.csv"</span>
	prefixCSV<span class="token operator">=</span><span class="token string">"prefix.csv"</span>

	<span class="token punctuation">(</span><span class="token punctuation">[</span> -f <span class="token variable">$baseCSV</span>  <span class="token punctuation">]</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">[</span> -f <span class="token variable">$baseCSV</span> <span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token punctuation">(</span>echo <span class="token string">"base and prefix do not exist"</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">exit</span> 1<span class="token punctuation">)</span>
	<span class="token punctuation">[</span> $<span class="token comment"># -eq 3 ] || (echo "insufficient args" &amp;&amp; exit 1)</span>
	num<span class="token operator">=</span><span class="token variable">$1</span> <span class="token comment"># 2.1</span>
	metric<span class="token operator">=</span><span class="token variable">$2</span> <span class="token comment"># M</span>
	metricSymbol<span class="token operator">=</span><span class="token variable">$3</span> <span class="token comment"># s</span>

	metricDecimal<span class="token operator">=</span><span class="token punctuation">$(</span>grep <span class="token string">",<span class="token variable">${metric}</span>,"</span> <span class="token variable">$prefixCSV</span> <span class="token operator">|</span> <span class="token function">awk</span> -F <span class="token string">","</span> <span class="token string">'{print <span class="token variable">$3</span>}'</span><span class="token punctuation">)</span> <span class="token comment"># e.g 1000000</span>

	metricRow<span class="token operator">=</span><span class="token punctuation">$(</span>grep <span class="token string">",<span class="token variable">${metricSymbol}</span>,"</span> <span class="token variable">$baseCSV</span><span class="token punctuation">)</span> <span class="token comment"># second,s,time</span>
	metricUnitName<span class="token operator">=</span><span class="token punctuation">$(</span>echo <span class="token variable">$metricRow</span> <span class="token operator">|</span> <span class="token function">awk</span> -F <span class="token string">","</span> <span class="token string">'{print <span class="token variable">$1</span>}'</span><span class="token punctuation">)</span> <span class="token comment"># second</span>
	metricMeasure<span class="token operator">=</span><span class="token punctuation">$(</span>echo <span class="token variable">$metricRow</span> <span class="token operator">|</span> <span class="token function">awk</span> -F <span class="token string">","</span> <span class="token string">'{print <span class="token variable">$3</span>}'</span><span class="token punctuation">)</span> <span class="token comment"># time</span>

	metricResult<span class="token operator">=</span><span class="token punctuation">$(</span>echo <span class="token string">"<span class="token variable">$num</span> * <span class="token variable">$metricDecimal</span>"</span> <span class="token operator">|</span> bc<span class="token punctuation">)</span>
	<span class="token keyword">echo</span> <span class="token string">"<span class="token variable">$metricResult</span> <span class="token variable">$metricSymbol</span> (<span class="token variable">$metricMeasure</span>, <span class="token variable">$metricUnitName</span>)"</span>
</code></pre>
<h3 id="ce-02">47. 2022-CE-02</h3>
<pre class=" language-bash"><code class="prism  language-bash">	<span class="token comment">#! /bin/bash</span>
	<span class="token punctuation">[</span> $<span class="token comment"># -eq 1 ] || (echo "insufficient args" &amp;&amp; exit 1)</span>
	DEVICE<span class="token operator">=</span><span class="token variable">$1</span>
	wakeUpDir<span class="token operator">=</span><span class="token string">"/home/students/s45811/scripts/wakeup"</span>
	<span class="token function">sed</span> -i -E <span class="token string">"s/\*/-=-/g"</span> <span class="token variable">$wakeUpDir</span> <span class="token comment"># LID S4 *enabled ... -&gt; LID S4 -=-enabled ...</span>

	currStatus<span class="token operator">=</span><span class="token punctuation">$(</span>grep <span class="token variable">$DEVICE</span> <span class="token variable">$wakeUpDir</span> <span class="token operator">|</span> <span class="token function">awk</span> <span class="token string">'{print <span class="token variable">$3</span>}'</span> <span class="token operator">|</span> <span class="token function">cut</span> -c 4-<span class="token punctuation">)</span> <span class="token comment"># enabled/disabled</span>
	oldLine<span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">grep</span> $DEVICE $wakeUpDir<span class="token variable">)</span></span>
	newLine<span class="token operator">=</span><span class="token punctuation">$(</span>echo <span class="token variable">$oldLine</span> <span class="token operator">|</span> <span class="token function">sed</span> -E <span class="token string">"s/<span class="token variable">$currStatus</span>/disabled/g"</span><span class="token punctuation">)</span>
	<span class="token function">sed</span> -i -E <span class="token string">"s/<span class="token variable">$oldLine</span>/<span class="token variable">$newLine</span>/g"</span> <span class="token variable">$wakeUpDir</span>
	<span class="token function">sed</span> -i -E <span class="token string">"s/-=-/\*/g"</span> <span class="token variable">$wakeUpDir</span>
</code></pre>
<h3 id="in-01">48. 2022-IN-01</h3>
<pre class=" language-bash"><code class="prism  language-bash">	<span class="token comment">#! /bin/bash</span>
	<span class="token punctuation">[</span> $<span class="token comment"># -eq 2 ] || exit 1</span>
	<span class="token punctuation">(</span><span class="token punctuation">[</span> -d <span class="token variable">$1</span> <span class="token punctuation">]</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">[</span> -d <span class="token variable">$2</span> <span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token keyword">exit</span> 2
	dir1<span class="token operator">=</span><span class="token variable">$1</span>
	dir2<span class="token operator">=</span><span class="token variable">$2</span>
	<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token punctuation">$(</span>find <span class="token variable">$dir1</span> -type f \<span class="token operator">!</span> -name <span class="token string">".*.swp"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">do</span>
	        newPath<span class="token operator">=</span><span class="token punctuation">$(</span>echo <span class="token variable">$i</span> <span class="token operator">|</span> <span class="token function">sed</span> -E <span class="token string">"s|<span class="token variable">$dir1</span>|<span class="token variable">$dir2</span>|1"</span><span class="token punctuation">)</span>
	        <span class="token function">mkdir</span> -p <span class="token string">"<span class="token variable"><span class="token variable">$(</span><span class="token function">dirname</span> $newPath<span class="token variable">)</span></span>"</span>
	        <span class="token function">cp</span> <span class="token variable">$i</span> <span class="token variable">$newPath</span>
	<span class="token keyword">done</span>
</code></pre>
<h3 id="in-04">50. 2022-IN-04</h3>
<pre class=" language-bash"><code class="prism  language-bash"><span class="token shebang important">#! /bin/bash</span>
<span class="token punctuation">[</span> $<span class="token comment"># -ge 3 ]  exit 1</span>
<span class="token punctuation">[</span> <span class="token punctuation">$(</span>echo <span class="token variable">$@</span><span class="token operator">|</span><span class="token function">grep</span> -o <span class="token string">"-jar"</span> <span class="token operator">|</span><span class="token function">wc</span> -l<span class="token punctuation">)</span> -eq 1 <span class="token punctuation">]</span>   <span class="token keyword">exit</span> 2
<span class="token punctuation">[</span> <span class="token variable">$1</span> <span class="token operator">==</span> <span class="token string">"java"</span> <span class="token punctuation">]</span> <span class="token operator">||</span> <span class="token keyword">exit</span> 3
jarLocation<span class="token operator">=</span><span class="token punctuation">$(</span>echo <span class="token variable">$@</span><span class="token operator">|</span><span class="token function">awk</span> <span class="token string">'{for(i=1;i&lt;=NF;i++){ if(<span class="token variable">$i</span>=="-jar") print i} }'</span><span class="token punctuation">)</span>
alldLocation<span class="token operator">=</span><span class="token punctuation">$(</span>echo <span class="token variable">$@</span><span class="token operator">|</span><span class="token function">awk</span> <span class="token string">'{output=""; for(i=1;i&lt;=NF;i++){ if(<span class="token variable">$i</span>~ /^-D.+=./) output=output" "<span class="token variable">$i</span>} print output}'</span><span class="token punctuation">)</span>
allDash<span class="token operator">=</span><span class="token punctuation">$(</span>echo <span class="token variable">$@</span><span class="token operator">|</span><span class="token function">awk</span> <span class="token string">'{ output=""; for(i=1;i&lt;=NF;i++){ if(<span class="token variable">$i!</span>~/^-jar/ &amp;&amp; <span class="token variable">$i!</span>~/^-D./ &amp;&amp; <span class="token variable">$i</span>~/^-./) output=output" "<span class="token variable">$i</span>} print output}'</span><span class="token punctuation">)</span>
path<span class="token operator">=</span><span class="token punctuation">$(</span>echo <span class="token variable">$@</span><span class="token operator">|</span><span class="token function">awk</span> <span class="token string">'{output=""; for(i=1;i&lt;=NF;i++){if(<span class="token variable">$i</span>~/..jar/) output=<span class="token variable">$i</span> } print output}'</span><span class="token punctuation">)</span>
<span class="token keyword">echo</span> <span class="token punctuation">$(</span> java <span class="token variable">${alldLocation}</span> -jar <span class="token variable">${path}</span> <span class="token variable">${allDash}</span>
</code></pre>
<h3 id="in-04-1">51. 2022-IN-04</h3>
<pre class=" language-bash"><code class="prism  language-bash">	<span class="token comment">#! /bin/bash</span>
	<span class="token punctuation">[</span> $<span class="token comment"># -eq 1 ] || exit 1</span>
	fugaDir<span class="token operator">=</span><span class="token variable">$1</span>
	validationScript<span class="token operator">=</span><span class="token string">"<span class="token variable">${fugaDir}</span>/validate.sh"</span>
	fugaCfg<span class="token operator">=</span><span class="token string">"<span class="token variable">${fugaDir}</span>/cfg"</span>
	authFile<span class="token operator">=</span><span class="token string">"<span class="token variable">${fugaDir}</span>/foo.pwd"</span> <span class="token comment"># user_name:hashed_password</span>
	configFile<span class="token operator">=</span><span class="token string">"<span class="token variable">${fugaDir}</span>/foo.conf"</span>
	tmpFile<span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span>mktemp<span class="token variable">)</span></span>
	<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token punctuation">$(</span>find <span class="token variable">$fugaCfg</span> -type f -name <span class="token string">"*.cfg"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">do</span>
	        userName<span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">basename</span> -s .cfg $i<span class="token variable">)</span></span>
	        <span class="token function">cat</span> <span class="token variable">$i</span> <span class="token operator">&gt;&gt;</span> <span class="token variable">$tmpFile</span>
	        validOutput<span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span>$validationScript $i<span class="token variable">)</span></span>
	        lastStatus<span class="token operator">=</span><span class="token variable">$?</span>
	        <span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token variable">$lastStatus</span> -eq 1 <span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">then</span>
	                <span class="token keyword">echo</span> -e <span class="token string">"<span class="token variable">$validOutput</span>"</span> <span class="token operator">|</span> <span class="token function">awk</span> -v currUsr<span class="token operator">=</span><span class="token variable">$i</span> <span class="token string">'{print currUsr ":" <span class="token variable">$0</span>}'</span> <span class="token operator">&gt;</span><span class="token operator">&amp;</span>2
	        <span class="token keyword">elif</span> <span class="token punctuation">[</span> <span class="token variable">$lastStatus</span> -eq 0 <span class="token punctuation">]</span>
	                <span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token variable"><span class="token variable">$(</span><span class="token function">grep</span> $userName $authFile <span class="token operator">|</span> <span class="token function">wc</span> -l<span class="token variable">)</span></span> -eq 0 <span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">then</span>
	                        newPass<span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span>pwgen 16 1<span class="token variable">)</span></span>
	                        hashedPass<span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span>mkpasswd $newPass<span class="token variable">)</span></span>
	                        <span class="token keyword">echo</span> <span class="token string">"<span class="token variable">${userName}</span>:<span class="token variable">${newPass}</span>"</span>
	                        <span class="token keyword">echo</span> <span class="token string">"<span class="token variable">${userName}</span>:<span class="token variable">${hashedPass}</span>"</span> <span class="token operator">&gt;&gt;</span> <span class="token variable">$authFile</span>
	                <span class="token keyword">fi</span>
	        <span class="token keyword">fi</span>
	<span class="token keyword">done</span>
	<span class="token function">cp</span> <span class="token variable">$tmpFile</span> <span class="token variable">${fugaDir}</span>/foo.conf
	<span class="token function">rm</span> <span class="token variable">$tmpFile</span>
</code></pre>
<h3 id="se-01-4">52. 2022-SE-01</h3>
<pre class=" language-bash"><code class="prism  language-bash">	<span class="token comment">#! /bin/bash</span>
	<span class="token punctuation">[</span> $<span class="token comment"># -eq 1 ] || (echo "insufficient args" &amp;&amp; exit 1)</span>
	fileLoc<span class="token operator">=</span><span class="token variable">$1</span>
	wakeUpDir<span class="token operator">=</span><span class="token string">"/home/students/s45811/scripts/wakeup"</span>
	<span class="token function">sed</span> -i -E <span class="token string">"s/\*/-=-/g"</span> <span class="token variable">$wakeUpDir</span> <span class="token comment"># LID S4 *enabled ... -&gt; LID S4 -=-enabled ...</span>

	<span class="token function">cat</span> <span class="token variable">$fileLoc</span> <span class="token operator">|</span> <span class="token keyword">while</span> <span class="token function">read</span> line
	<span class="token keyword">do</span>
	        currLine<span class="token operator">=</span><span class="token punctuation">$(</span>echo <span class="token variable">$line</span> <span class="token operator">|</span> <span class="token function">sed</span> -E <span class="token string">"s/#.*//g"</span><span class="token punctuation">)</span>
	        <span class="token keyword">if</span> <span class="token punctuation">[</span> -n <span class="token string">"<span class="token variable">$currLine</span>"</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
	                currDevice<span class="token operator">=</span><span class="token punctuation">$(</span>echo <span class="token variable">$currLine</span> <span class="token operator">|</span> <span class="token function">awk</span> <span class="token string">'{print <span class="token variable">$1</span>}'</span><span class="token punctuation">)</span>
	                currStatus<span class="token operator">=</span><span class="token punctuation">$(</span>echo <span class="token variable">$currLine</span> <span class="token operator">|</span> <span class="token function">awk</span> <span class="token string">'{print <span class="token variable">$2</span>}'</span><span class="token punctuation">)</span>
	                <span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token variable"><span class="token variable">$(</span><span class="token function">grep</span> $currDevice $wakeUpDir <span class="token operator">|</span> <span class="token function">wc</span> -l<span class="token variable">)</span></span> -eq 0 <span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">then</span>
	                        <span class="token keyword">echo</span> <span class="token string">"Device <span class="token variable">$currDevice</span> doesn't exist in wakeup file."</span> <span class="token operator">&gt;</span><span class="token operator">&amp;</span>2
	                <span class="token keyword">else</span>
	                        oldLine<span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">grep</span> $currDevice $wakeUpDir<span class="token variable">)</span></span>
	                        oldStatus<span class="token operator">=</span><span class="token punctuation">$(</span>echo <span class="token variable">$oldLine</span> <span class="token operator">|</span> <span class="token function">awk</span> <span class="token string">'{print <span class="token variable">$3</span>}'</span> <span class="token operator">|</span> <span class="token function">cut</span> -c 4-<span class="token punctuation">)</span>
	                        newLine<span class="token operator">=</span><span class="token punctuation">$(</span>echo <span class="token variable">$oldLine</span> <span class="token operator">|</span> <span class="token function">sed</span> -E <span class="token string">"s/<span class="token variable">$oldStatus</span>/<span class="token variable">$currStatus</span>/g"</span><span class="token punctuation">)</span>
	                        <span class="token function">sed</span> -i -E <span class="token string">"s/<span class="token variable">$oldLine</span>/<span class="token variable">$newLine</span>/g"</span> <span class="token variable">$wakeUpDir</span>
	                <span class="token keyword">fi</span>
	        <span class="token keyword">fi</span>
	<span class="token keyword">done</span>
	<span class="token function">sed</span> -i -E <span class="token string">"s/-=-/\*/g"</span> <span class="token variable">$wakeUpDir</span>
</code></pre>
<h3 id="se-02-4">53. 2022-SE-02</h3>
<pre class=" language-bash"><code class="prism  language-bash"><span class="token shebang important">#! /bin/bash</span>

<span class="token punctuation">[</span> $<span class="token comment"># -eq 2 ] || exit 1</span>
<span class="token punctuation">[</span> -d <span class="token variable">$1</span> <span class="token punctuation">]</span> <span class="token operator">||</span> <span class="token keyword">exit</span> 2
<span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token variable">$2</span> <span class="token operator">=</span>~ ^<span class="token punctuation">[</span>0-9<span class="token punctuation">]</span><span class="token punctuation">{</span>1,2<span class="token punctuation">}</span> <span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">||</span> <span class="token keyword">exit</span> 3

DIR<span class="token operator">=</span><span class="token variable">$1</span>
PERCENTAGE<span class="token operator">=</span><span class="token variable">$2</span>

yearly<span class="token operator">=</span><span class="token string">""</span>
monthly<span class="token operator">=</span><span class="token string">""</span>
weekly<span class="token operator">=</span><span class="token string">""</span>
daily<span class="token operator">=</span><span class="token string">""</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token punctuation">$(</span>find <span class="token variable">$DIR</span> -name <span class="token string">"*.tar.xz"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">do</span>
        formated<span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">basename</span> -s .tar.xz $i<span class="token variable">)</span></span>
        dateTimeInSec<span class="token operator">=</span><span class="token punctuation">$(</span>date <span class="token punctuation">$(</span>echo <span class="token variable">$formated</span> <span class="token operator">|</span> <span class="token function">cut</span> -d <span class="token string">"-"</span> -f 3<span class="token punctuation">)</span> +<span class="token string">"%s"</span><span class="token punctuation">)</span>
        hostname<span class="token operator">=</span><span class="token punctuation">$(</span>echo <span class="token variable">$formated</span> <span class="token operator">|</span> <span class="token function">cut</span> -d <span class="token string">"-"</span> -f 1<span class="token punctuation">)</span>
        area<span class="token operator">=</span><span class="token punctuation">$(</span>echo <span class="token variable">$formated</span> <span class="token operator">|</span> <span class="token function">cut</span> -d <span class="token string">"-"</span> -f 2<span class="token punctuation">)</span>
        objName<span class="token operator">=</span><span class="token string">"<span class="token variable">${hostname}</span>-<span class="token variable">${area}</span>"</span>

        todaysDate<span class="token operator">=</span><span class="token punctuation">$(</span>date +<span class="token string">"%s"</span><span class="token punctuation">)</span>
        difference<span class="token operator">=</span><span class="token variable"><span class="token variable">$((</span>$todaysDate <span class="token operator">-</span> $dateTimeInSec<span class="token variable">))</span></span>
        diffInDays<span class="token operator">=</span><span class="token variable"><span class="token variable">$((</span>$difference <span class="token operator">/</span> <span class="token number">86400</span><span class="token variable">))</span></span>
        <span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token variable">$diffInDays</span> -ge 365 <span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">then</span>
                yearly<span class="token operator">=</span><span class="token string">"<span class="token variable">$yearly</span>\n<span class="token variable">$i</span>"</span>
        <span class="token keyword">elif</span> <span class="token punctuation">[</span> <span class="token variable">$diffInDays</span> -ge 30 <span class="token punctuation">]</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">[</span> <span class="token variable">$diffInDays</span> -le 364 <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
                monthly<span class="token operator">=</span><span class="token string">"<span class="token variable">$monthly</span>\n<span class="token variable">$i</span>"</span>
        <span class="token keyword">elif</span> <span class="token punctuation">[</span> <span class="token variable">$diffInDays</span> -ge 7 <span class="token punctuation">]</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">[</span> <span class="token variable">$diffInDays</span> -le 29 <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
                weekly<span class="token operator">=</span><span class="token string">"<span class="token variable">$weekly</span>\n<span class="token variable">$i</span>"</span>
        <span class="token keyword">else</span>
                daily<span class="token operator">=</span><span class="token string">"<span class="token variable">$daily</span>\n<span class="token variable">$i</span>"</span>
        <span class="token keyword">fi</span>
<span class="token keyword">done</span>

yearly<span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token keyword">echo</span> -e $yearly <span class="token operator">|</span> <span class="token function">tail</span> -n +2<span class="token variable">)</span></span>
monthly<span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token keyword">echo</span> -e $monthly <span class="token operator">|</span> <span class="token function">tail</span> -n +2<span class="token variable">)</span></span>
weekly<span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token keyword">echo</span> -e $weekly <span class="token operator">|</span> <span class="token function">tail</span> -n +2<span class="token variable">)</span></span>
daily<span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token keyword">echo</span> -e $daily <span class="token operator">|</span> <span class="token function">tail</span> -n +2<span class="token variable">)</span></span>

<span class="token keyword">while</span> <span class="token function">read</span> i <span class="token punctuation">;</span> <span class="token keyword">do</span>
   <span class="token function">rm</span> <span class="token variable">$i</span>
done<span class="token operator">&lt;</span> <span class="token operator">&lt;</span><span class="token punctuation">(</span>find -L <span class="token variable">${DIR}</span> -type l<span class="token punctuation">)</span>

<span class="token keyword">while</span> <span class="token function">read</span> i<span class="token punctuation">;</span> <span class="token keyword">do</span>
                formated<span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">basename</span> -s .tar.xz $i<span class="token variable">)</span></span>
        dateTimeInSec<span class="token operator">=</span><span class="token punctuation">$(</span>date <span class="token punctuation">$(</span>echo <span class="token variable">$formated</span> <span class="token operator">|</span> <span class="token function">cut</span> -d <span class="token string">"-"</span> -f 3<span class="token punctuation">)</span> +<span class="token string">"%s"</span><span class="token punctuation">)</span>
        hostname<span class="token operator">=</span><span class="token punctuation">$(</span>echo <span class="token variable">$formated</span> <span class="token operator">|</span> <span class="token function">cut</span> -d <span class="token string">"-"</span> -f 1<span class="token punctuation">)</span>
        area<span class="token operator">=</span><span class="token punctuation">$(</span>echo <span class="token variable">$formated</span> <span class="token operator">|</span> <span class="token function">cut</span> -d <span class="token string">"-"</span> -f 2<span class="token punctuation">)</span>
        objName<span class="token operator">=</span><span class="token string">"<span class="token variable">${hostname}</span>-<span class="token variable">${area}</span>"</span>

                <span class="token keyword">while</span> <span class="token punctuation">[</span> <span class="token punctuation">$(</span>echo -e <span class="token variable">$yearly</span> <span class="token operator">|</span> <span class="token function">grep</span> -c <span class="token string">"<span class="token variable">$objName</span>"</span><span class="token punctuation">)</span> -gt 1 <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">do</span>
                        totalPercentage<span class="token operator">=</span><span class="token punctuation">$(</span>find <span class="token variable">$DIR</span> -name <span class="token string">"*.tar.xz"</span> <span class="token operator">|</span> <span class="token function">rev</span> <span class="token operator">|</span> <span class="token function">sort</span> -t <span class="token string">"-"</span> -k 2,3 -k 1,1 <span class="token operator">|</span> <span class="token function">sed</span> -E <span class="token string">"s/-/\t/"</span> <span class="token operator">|</span> <span class="token function">uniq</span> -f 1 <span class="token operator">|</span> <span class="token function">tr</span> <span class="token string">'\t'</span> <span class="token string">'-'</span> <span class="token operator">|</span> <span class="token function">rev</span> <span class="token operator">|</span> <span class="token function">sort</span> <span class="token punctuation">)</span>
                        <span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token variable">$totalPercentage</span> -gt <span class="token variable">$PERCENTAGE</span> <span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">then</span>
                                toRemove<span class="token operator">=</span><span class="token punctuation">$(</span>echo -e <span class="token variable">$yearly</span> <span class="token operator">|</span> <span class="token function">sort</span> <span class="token operator">|</span> <span class="token function">grep</span> <span class="token string">"<span class="token variable">$objName</span>"</span> <span class="token operator">|</span> <span class="token function">head</span> -n 1<span class="token punctuation">)</span>
                                <span class="token function">rm</span> <span class="token punctuation">$(</span>find <span class="token variable">$DIR</span> -name <span class="token string">"<span class="token variable">$toRemove</span>"</span> <span class="token operator">|</span> <span class="token function">head</span> -n 1<span class="token punctuation">)</span>
                        <span class="token keyword">fi</span>
                <span class="token keyword">done</span>
                <span class="token keyword">while</span> <span class="token punctuation">[</span> <span class="token punctuation">$(</span>echo -e <span class="token variable">$monthly</span> <span class="token operator">|</span> <span class="token function">grep</span> -c <span class="token string">"<span class="token variable">$objName</span>"</span><span class="token punctuation">)</span> -gt 1 <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">do</span>
                        totalPercentage<span class="token operator">=</span><span class="token punctuation">$(</span>find <span class="token variable">$DIR</span> -name <span class="token string">"*.tar.xz"</span> <span class="token operator">|</span> <span class="token function">rev</span> <span class="token operator">|</span> <span class="token function">sort</span> -t <span class="token string">"-"</span> -k 2,3 -k 1,1 <span class="token operator">|</span> <span class="token function">sed</span> -E <span class="token string">"s/-/\t/"</span> <span class="token operator">|</span> <span class="token function">uniq</span> -f 1 <span class="token operator">|</span> <span class="token function">tr</span> <span class="token string">'\t'</span> <span class="token string">'-'</span> <span class="token operator">|</span> <span class="token function">rev</span> <span class="token operator">|</span> <span class="token function">sort</span> <span class="token punctuation">)</span>
                        <span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token variable">$totalPercentage</span> -gt <span class="token variable">$PERCENTAGE</span> <span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">then</span>
                                toRemove<span class="token operator">=</span><span class="token punctuation">$(</span>echo -e <span class="token variable">$monthly</span> <span class="token operator">|</span> <span class="token function">sort</span> <span class="token operator">|</span> <span class="token function">grep</span> <span class="token string">"<span class="token variable">$objName</span>"</span> <span class="token operator">|</span> <span class="token function">head</span> -n 1<span class="token punctuation">)</span>
                                <span class="token function">rm</span> <span class="token punctuation">$(</span>find <span class="token variable">$DIR</span> -name <span class="token string">"<span class="token variable">$toRemove</span>"</span> <span class="token operator">|</span> <span class="token function">head</span> -n 1<span class="token punctuation">)</span>
                        <span class="token keyword">fi</span>
                <span class="token keyword">done</span>
                <span class="token keyword">while</span> <span class="token punctuation">[</span> <span class="token punctuation">$(</span>echo -e <span class="token variable">$weekly</span> <span class="token operator">|</span> <span class="token function">grep</span> -c <span class="token string">"<span class="token variable">$objName</span>"</span><span class="token punctuation">)</span> -gt 1 <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">do</span>
                        totalPercentage<span class="token operator">=</span><span class="token punctuation">$(</span>find <span class="token variable">$DIR</span> -name <span class="token string">"*.tar.xz"</span> <span class="token operator">|</span> <span class="token function">rev</span> <span class="token operator">|</span> <span class="token function">sort</span> -t <span class="token string">"-"</span> -k 2,3 -k 1,1 <span class="token operator">|</span> <span class="token function">sed</span> -E <span class="token string">"s/-/\t/"</span> <span class="token operator">|</span> <span class="token function">uniq</span> -f 1 <span class="token operator">|</span> <span class="token function">tr</span> <span class="token string">'\t'</span> <span class="token string">'-'</span> <span class="token operator">|</span> <span class="token function">rev</span> <span class="token operator">|</span> <span class="token function">sort</span> <span class="token punctuation">)</span>
                        <span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token variable">$totalPercentage</span> -gt <span class="token variable">$PERCENTAGE</span> <span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">then</span>
                                toRemove<span class="token operator">=</span><span class="token punctuation">$(</span>echo -e <span class="token variable">$weekly</span> <span class="token operator">|</span> <span class="token function">sort</span> <span class="token operator">|</span> <span class="token function">grep</span> <span class="token string">"<span class="token variable">$objName</span>"</span> <span class="token operator">|</span> <span class="token function">head</span> -n 1<span class="token punctuation">)</span>
                                <span class="token function">rm</span> <span class="token punctuation">$(</span>find <span class="token variable">$DIR</span> -name <span class="token string">"<span class="token variable">$toRemove</span>"</span> <span class="token operator">|</span> <span class="token function">head</span> -n 1<span class="token punctuation">)</span>
                        <span class="token keyword">fi</span>
                <span class="token keyword">done</span>
                <span class="token keyword">while</span> <span class="token punctuation">[</span> <span class="token punctuation">$(</span>echo -e <span class="token variable">$daily</span> <span class="token operator">|</span> <span class="token function">grep</span> -c <span class="token string">"<span class="token variable">$objName</span>"</span><span class="token punctuation">)</span> -gt 1 <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">do</span>
                        totalPercentage<span class="token operator">=</span><span class="token punctuation">$(</span>find <span class="token variable">$DIR</span> -name <span class="token string">"*.tar.xz"</span> <span class="token operator">|</span> <span class="token function">rev</span> <span class="token operator">|</span> <span class="token function">sort</span> -t <span class="token string">"-"</span> -k 2,3 -k 1,1 <span class="token operator">|</span> <span class="token function">sed</span> -E <span class="token string">"s/-/\t/"</span> <span class="token operator">|</span> <span class="token function">uniq</span> -f 1 <span class="token operator">|</span> <span class="token function">tr</span> <span class="token string">'\t'</span> <span class="token string">'-'</span> <span class="token operator">|</span> <span class="token function">rev</span> <span class="token operator">|</span> <span class="token function">sort</span> <span class="token punctuation">)</span>
                        <span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token variable">$totalPercentage</span> -gt <span class="token variable">$PERCENTAGE</span> <span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">then</span>
                                toRemove<span class="token operator">=</span><span class="token punctuation">$(</span>echo -e <span class="token variable">$daily</span> <span class="token operator">|</span> <span class="token function">sort</span> <span class="token operator">|</span> <span class="token function">grep</span> <span class="token string">"<span class="token variable">$objName</span>"</span> <span class="token operator">|</span> <span class="token function">head</span> -n 1<span class="token punctuation">)</span>
                                <span class="token function">rm</span> <span class="token punctuation">$(</span>find <span class="token variable">$DIR</span> -name <span class="token string">"<span class="token variable">$toRemove</span>"</span> <span class="token operator">|</span> <span class="token function">head</span> -n 1<span class="token punctuation">)</span>
                        <span class="token keyword">fi</span>
                <span class="token keyword">done</span>
<span class="token keyword">done</span> <span class="token operator">&lt;</span> <span class="token operator">&lt;</span><span class="token punctuation">(</span>find <span class="token variable">$DIR</span> -name <span class="token string">"*.tar.xz"</span> <span class="token operator">|</span> <span class="token function">rev</span> <span class="token operator">|</span> <span class="token function">sort</span> -t <span class="token string">"-"</span> -k 2,3 -k 1,1 <span class="token operator">|</span> <span class="token function">sed</span> -E <span class="token string">"s/-/\t/"</span> <span class="token operator">|</span> <span class="token function">uniq</span> -f 1 <span class="token operator">|</span> <span class="token function">tr</span> <span class="token string">'\t'</span> <span class="token string">'-'</span> <span class="token operator">|</span> <span class="token function">rev</span> <span class="token operator">|</span> <span class="token function">sort</span> <span class="token punctuation">)</span>

<span class="token keyword">while</span> <span class="token function">read</span> i <span class="token punctuation">;</span> <span class="token keyword">do</span>
   <span class="token function">rm</span> <span class="token variable">$i</span>
done<span class="token operator">&lt;</span> <span class="token operator">&lt;</span><span class="token punctuation">(</span>find -L <span class="token variable">${DIR}</span> -type l<span class="token punctuation">)</span>

<span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token punctuation">$(</span>find <span class="token variable">$DIR</span> -name <span class="token string">"*.tar.xz"</span> <span class="token operator">|</span> <span class="token function">rev</span> <span class="token operator">|</span> <span class="token function">sort</span> -t <span class="token string">"-"</span> -k 2,3 -k 1,1 <span class="token operator">|</span> <span class="token function">sed</span> -E <span class="token string">"s/-/\t/"</span> <span class="token operator">|</span> <span class="token function">uniq</span> -f 1 <span class="token operator">|</span> <span class="token function">tr</span> <span class="token string">'\t'</span> <span class="token string">'-'</span> <span class="token operator">|</span> <span class="token function">rev</span> <span class="token operator">|</span> <span class="token function">sort</span> <span class="token punctuation">)</span> -gt <span class="token variable">$PERCENTAGE</span> <span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">then</span>
        <span class="token keyword">echo</span> <span class="token string">"Deleted everything I could... Still not enough"</span>
<span class="token keyword">fi</span>
</code></pre>
</div>
</body>

</html>
